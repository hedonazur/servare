{% extends 'share/base_site.html' %}
{% load i18n %}

{% block content %}
<div class="container suggest_form">

  <h3>Add new collections</h3><br>
    <div id="error_message"></div>
  {% if messages %}
      <ul class="messages alert alert-info">
         {% for message in messages %}
             <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
         {% endfor %}
      </ul>
  {% endif %}


    <form class="form-horizontal" action="{% url 'collection:new_collection' %}" method="post">
      {% csrf_token %}
      <div class="form-group ">
          <label for="title" class="col-sm-2 control-label">Title</label>
          <div class="col-sm-10">
              <input type="text" class="form-control" id="title" name="title" required />
          </div>
      </div>

      <div class="form-group ">
          <label for="author" class="col-sm-2 control-label">Author</label>
          <div class="col-sm-10">
              <input type="text" class="form-control" id="author" name="author"/>
          </div>
      </div>

      <div class="form-group ">
          <label for="collection_text" class="col-sm-2 control-label">Text</label>
          <div class="col-sm-10">
              <textarea type="text" class="form-control" id="collection_text" name="text" required /></textarea>
          </div>
          <div id="text_link">
              <input type="text" class="text_input form-control col-sm-1" onkeypress="this.style.width = ((this.value.length + 15) * 8) + 'px';" name="text" required />
          </div>
      </div>

      <div class="form-group">
          <label for="type" class="col-sm-2 control-label">Type</label>
          <div class="col-sm-10" id="types">
                {% for type in collection_types %}
                    <input type="radio" name="type" value="{{ type.name }}" checked required> {% trans type.name %}
                {% endfor %}
          </div>

      </div>

      <div class="form-group">
        <div class="col-xs-offset-2 col-xs-3">
          <button type="submit" class="btn btn-primary">{% trans "Save" %}</button>
        </div>

        <div class="col-xs-offset-2 col-xs-3 col-sm-offset-4 col-sm-3">
          <a class="btn btn-primary suggest-another-button">{% trans "Save and validate" %}</a>
        </div>

      </div>
    </form>


<div id="mySidenav" class="sidenav">
  <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
  <a href="#">About</a>
  <a href="#">Services</a>
  <a href="#">Clients</a>
  <a href="#">Contact</a>
</div>


<span style="font-size:30px;cursor:pointer" onclick="openNav()">&#9776; open</span>



</div>

<script>
function openNav() {
  document.getElementById("mySidenav").style.width = "350px";
}

function closeNav() {
  document.getElementById("mySidenav").style.width = "0";
}

$(document).ready(function(){

    $('#text_link').keydown(function(e){
        if(e.keyCode == 32)
        {
            $('.text_input:last-child').after('<input type="text" class="text_input form-control col-sm-1" onkeypress="this.style.width = ((this.value.length + 15) * 8) + \'px\';" name="text" required />');
            $('.text_input:last-child').focus();
            var text = $('.text_input').eq(-2).val()
            $('.text_input').eq(-2).replaceWith( '<div class="text_value" ><a>' +text +'</a></div>');
        }
    });
    $('#text_link').keyup(function(e){
        if (($('.text_input:last-child').val().length === 0) && (e.keyCode == 8))
        {
            var text = $('.text_value a').eq(-1).text()
            $('.text_value').eq(-1).remove().replaceWith('<input type="text" class="text_input form-control col-sm-1" onkeypress="this.style.width = ((this.value.length + 15) * 8) + \'px\';" name="text" required />');
            $('.text_input:last-child').val(text);
            console.log(text)
        }

    });

    function openNav() {
      document.getElementById("mySidenav").style.width = "850px";
    }

    function closeNav() {
      document.getElementById("mySidenav").style.width = "0";
    }



});
</script>

{% endblock %}